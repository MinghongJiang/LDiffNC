INFO:root:--epoch: 400 --dataset: CIFAR10 --imb_factor:0.01 --feature_ratio:0.2 --diffusion_step:1000 (DDPM official)
INFO:root:Test performance on test set.
INFO:root:fc_norm = False in model config, fc_layer = nn.Linear
INFO:root:'none' given in ['ensemble_info']['name'], load regular network.
INFO:root:epoch: 0, the diffusion loss is 7.051721057113336
INFO:root:epoch: 1, the diffusion loss is 0.7232121740068708
INFO:root:epoch: 2, the diffusion loss is 0.687665328687551
INFO:root:epoch: 3, the diffusion loss is 0.6501228651221918
INFO:root:epoch: 4, the diffusion loss is 0.6473293797093995
INFO:root:epoch: 5, the diffusion loss is 0.5833472420974654
INFO:root:epoch: 6, the diffusion loss is 0.5864750955786023
INFO:root:epoch: 7, the diffusion loss is 0.527986617720857
INFO:root:epoch: 8, the diffusion loss is 0.5653680161553987
INFO:root:epoch: 9, the diffusion loss is 0.6284395176537183
INFO:root:epoch: 10, the diffusion loss is 0.5212875130225201
INFO:root:epoch: 11, the diffusion loss is 0.5198807308868486
INFO:root:epoch: 12, the diffusion loss is 0.5929133326423411
INFO:root:epoch: 13, the diffusion loss is 0.504751725464451
INFO:root:epoch: 14, the diffusion loss is 0.5141892706861302
INFO:root:epoch: 15, the diffusion loss is 0.5049772365969054
INFO:root:epoch: 16, the diffusion loss is 0.5080970659547922
INFO:root:epoch: 17, the diffusion loss is 0.5168070069381169
INFO:root:epoch: 18, the diffusion loss is 0.5465057711212002
INFO:root:epoch: 19, the diffusion loss is 0.5188325600964683
INFO:root:epoch: 20, the diffusion loss is 0.5007725114725075
INFO:root:epoch: 21, the diffusion loss is 0.5099976379044202
INFO:root:epoch: 22, the diffusion loss is 0.5691043114175602
INFO:root:epoch: 23, the diffusion loss is 0.519704165507336
INFO:root:epoch: 24, the diffusion loss is 0.5143574847250568
INFO:root:epoch: 25, the diffusion loss is 0.49225691569094754
INFO:root:epoch: 26, the diffusion loss is 0.6737190302537412
INFO:root:epoch: 27, the diffusion loss is 0.4914827298144905
INFO:root:epoch: 28, the diffusion loss is 0.49736296644016187
INFO:root:epoch: 29, the diffusion loss is 0.5487325793626358
INFO:root:epoch: 30, the diffusion loss is 0.4925770905553078
INFO:root:epoch: 31, the diffusion loss is 0.5036710014148634
INFO:root:epoch: 32, the diffusion loss is 0.5096789756599738
INFO:root:epoch: 33, the diffusion loss is 0.4814028654779707
INFO:root:epoch: 34, the diffusion loss is 0.512483365073496
INFO:root:epoch: 35, the diffusion loss is 0.48606846162251066
INFO:root:epoch: 36, the diffusion loss is 0.5041393905269856
INFO:root:epoch: 37, the diffusion loss is 0.4896380743201898
INFO:root:epoch: 38, the diffusion loss is 0.4799690143186219
INFO:root:epoch: 39, the diffusion loss is 0.49569675752094816
INFO:root:epoch: 40, the diffusion loss is 0.5289258713624916
INFO:root:epoch: 41, the diffusion loss is 0.5230301417866532
INFO:root:epoch: 42, the diffusion loss is 0.4753846197712178
INFO:root:epoch: 43, the diffusion loss is 0.4736152990740173
INFO:root:epoch: 44, the diffusion loss is 0.5101792550816828
INFO:root:epoch: 45, the diffusion loss is 0.47832416879887485
INFO:root:epoch: 46, the diffusion loss is 0.4850983613607835
INFO:root:epoch: 47, the diffusion loss is 0.48114574016356954
INFO:root:epoch: 48, the diffusion loss is 0.47639285544959864
INFO:root:epoch: 49, the diffusion loss is 0.4652504562115183
INFO:root:epoch: 50, the diffusion loss is 0.5030852446750719
INFO:root:epoch: 51, the diffusion loss is 0.4946370179555854
INFO:root:epoch: 52, the diffusion loss is 0.4753709186096581
INFO:root:epoch: 53, the diffusion loss is 0.46091446827869026
INFO:root:epoch: 54, the diffusion loss is 0.4731532456923504
INFO:root:epoch: 55, the diffusion loss is 0.4728670758860452
INFO:root:epoch: 56, the diffusion loss is 0.4626796999756171
INFO:root:epoch: 57, the diffusion loss is 0.4688751873921375
INFO:root:epoch: 58, the diffusion loss is 0.47112394778095945
INFO:root:epoch: 59, the diffusion loss is 0.455528088370148
INFO:root:epoch: 60, the diffusion loss is 0.514337807893753
INFO:root:epoch: 61, the diffusion loss is 0.46186227032116484
INFO:root:epoch: 62, the diffusion loss is 0.46134855309311223
INFO:root:epoch: 63, the diffusion loss is 0.4621899438147642
INFO:root:epoch: 64, the diffusion loss is 0.456620243130898
INFO:root:epoch: 65, the diffusion loss is 0.4694567274074165
INFO:root:epoch: 66, the diffusion loss is 0.48249645379124856
INFO:root:epoch: 67, the diffusion loss is 0.5054175136040668
INFO:root:epoch: 68, the diffusion loss is 0.48369303041574907
INFO:root:epoch: 69, the diffusion loss is 0.46204858106009816
INFO:root:epoch: 70, the diffusion loss is 0.46042354374515765
INFO:root:epoch: 71, the diffusion loss is 0.4553632669302882
INFO:root:epoch: 72, the diffusion loss is 0.4552763007125076
INFO:root:epoch: 73, the diffusion loss is 0.46577155590057373
INFO:root:epoch: 74, the diffusion loss is 0.45413887865689334
INFO:root:epoch: 75, the diffusion loss is 0.45240932033986464
INFO:root:epoch: 76, the diffusion loss is 0.45856414279159236
INFO:root:epoch: 77, the diffusion loss is 0.45426744770030586
INFO:root:epoch: 78, the diffusion loss is 0.44628939336659956
INFO:root:epoch: 79, the diffusion loss is 0.5068516050066266
INFO:root:epoch: 80, the diffusion loss is 0.45545363608671696
INFO:root:epoch: 81, the diffusion loss is 0.47469747248961003
INFO:root:epoch: 82, the diffusion loss is 0.44582367916496435
INFO:root:epoch: 83, the diffusion loss is 0.4514664302066881
INFO:root:epoch: 84, the diffusion loss is 0.4442060188371308
INFO:root:epoch: 85, the diffusion loss is 0.451649435320679
INFO:root:epoch: 86, the diffusion loss is 0.45283612730551737
INFO:root:epoch: 87, the diffusion loss is 0.4473863250138808
INFO:root:epoch: 88, the diffusion loss is 0.44083348463992683
INFO:root:epoch: 89, the diffusion loss is 0.5403182816748716
INFO:root:epoch: 90, the diffusion loss is 0.4454224073157019
INFO:root:epoch: 91, the diffusion loss is 0.4379147656109868
INFO:root:epoch: 92, the diffusion loss is 0.44328027781175106
INFO:root:epoch: 93, the diffusion loss is 0.4400959598774813
INFO:root:epoch: 94, the diffusion loss is 0.45882713551423987
INFO:root:epoch: 95, the diffusion loss is 0.43919821600524744
INFO:root:epoch: 96, the diffusion loss is 0.4318433732402568
INFO:root:epoch: 97, the diffusion loss is 0.4472817237279853
INFO:root:epoch: 98, the diffusion loss is 0.43658147965158733
INFO:root:epoch: 99, the diffusion loss is 0.4398669296381425
INFO:root:epoch: 100, the diffusion loss is 0.4442149625749004
INFO:root:epoch: 101, the diffusion loss is 0.4449590140459489
INFO:root:epoch: 102, the diffusion loss is 0.44516192771950547
INFO:root:epoch: 103, the diffusion loss is 0.4407737911963949
INFO:root:epoch: 104, the diffusion loss is 0.4381255093885928
INFO:root:epoch: 105, the diffusion loss is 0.4441836524982842
INFO:root:epoch: 106, the diffusion loss is 0.4460564292207056
INFO:root:epoch: 107, the diffusion loss is 0.43973296576616716
INFO:root:epoch: 108, the diffusion loss is 0.44547643406050547
INFO:root:epoch: 109, the diffusion loss is 0.4391037371693825
INFO:root:epoch: 110, the diffusion loss is 0.43929942469207606
INFO:root:epoch: 111, the diffusion loss is 0.4386605681205282
INFO:root:epoch: 112, the diffusion loss is 0.4391794788594149
INFO:root:epoch: 113, the diffusion loss is 0.43820475802129627
INFO:root:epoch: 114, the diffusion loss is 0.4356029398587285
INFO:root:epoch: 115, the diffusion loss is 0.4336190777165549
INFO:root:epoch: 116, the diffusion loss is 0.42669107232775005
INFO:root:epoch: 117, the diffusion loss is 0.44375793727076784
INFO:root:epoch: 118, the diffusion loss is 0.45486534128383715
INFO:root:epoch: 119, the diffusion loss is 0.45297141707673366
INFO:root:epoch: 120, the diffusion loss is 0.4314944817095387
INFO:root:epoch: 121, the diffusion loss is 0.42653392650643174
INFO:root:epoch: 122, the diffusion loss is 0.43881558155526923
INFO:root:epoch: 123, the diffusion loss is 0.42963592251952815
INFO:root:epoch: 124, the diffusion loss is 0.42908581848047217
INFO:root:epoch: 125, the diffusion loss is 0.4531265941201424
INFO:root:epoch: 126, the diffusion loss is 0.43216249529196293
INFO:root:epoch: 127, the diffusion loss is 0.4313233950916602
INFO:root:epoch: 128, the diffusion loss is 0.4340071228085732
INFO:root:epoch: 129, the diffusion loss is 0.4406193744163124
INFO:root:epoch: 130, the diffusion loss is 0.4667805968498697
INFO:root:epoch: 131, the diffusion loss is 0.4295963012442297
INFO:root:epoch: 132, the diffusion loss is 0.42375958026671895
INFO:root:epoch: 133, the diffusion loss is 0.43027866251614627
INFO:root:epoch: 134, the diffusion loss is 0.43043800884363603
INFO:root:epoch: 135, the diffusion loss is 0.46883346718184804
INFO:root:epoch: 136, the diffusion loss is 0.425473438841956
INFO:root:epoch: 137, the diffusion loss is 0.421875430613148
INFO:root:epoch: 138, the diffusion loss is 0.44544818449993523
INFO:root:epoch: 139, the diffusion loss is 0.4278008238393433
INFO:root:epoch: 140, the diffusion loss is 0.43000124668588446
INFO:root:epoch: 141, the diffusion loss is 0.42736480795607273
INFO:root:epoch: 142, the diffusion loss is 0.4310101301086192
INFO:root:epoch: 143, the diffusion loss is 0.4375524070798134
INFO:root:epoch: 144, the diffusion loss is 0.42802476031439646
INFO:root:epoch: 145, the diffusion loss is 0.4284886991491123
INFO:root:epoch: 146, the diffusion loss is 0.4237058332988194
INFO:root:epoch: 147, the diffusion loss is 0.44415718986063585
INFO:root:epoch: 148, the diffusion loss is 0.43094058243595823
INFO:root:epoch: 149, the diffusion loss is 0.42347191851966237
INFO:root:epoch: 150, the diffusion loss is 0.42869321849881387
INFO:root:epoch: 151, the diffusion loss is 0.4261735592569624
INFO:root:epoch: 152, the diffusion loss is 0.4258481124225928
INFO:root:epoch: 153, the diffusion loss is 0.42475421209724584
INFO:root:epoch: 154, the diffusion loss is 0.42163971978790904
INFO:root:epoch: 155, the diffusion loss is 0.43566715534852474
INFO:root:epoch: 156, the diffusion loss is 0.42145608091840936
INFO:root:epoch: 157, the diffusion loss is 0.41948545344021854
INFO:root:epoch: 158, the diffusion loss is 0.4097546034929704
INFO:root:epoch: 159, the diffusion loss is 0.4178136824345102
INFO:root:epoch: 160, the diffusion loss is 0.4267869330182367
INFO:root:epoch: 161, the diffusion loss is 0.4288106317422828
INFO:root:epoch: 162, the diffusion loss is 0.4172686265439403
INFO:root:epoch: 163, the diffusion loss is 0.42340755584288614
INFO:root:epoch: 164, the diffusion loss is 0.42570535321624914
INFO:root:epoch: 165, the diffusion loss is 0.42629132526261465
INFO:root:epoch: 166, the diffusion loss is 0.4334690224151222
INFO:root:epoch: 167, the diffusion loss is 0.421323407061246
INFO:root:epoch: 168, the diffusion loss is 0.4281641050260894
INFO:root:epoch: 169, the diffusion loss is 0.420780672710769
INFO:root:epoch: 170, the diffusion loss is 0.4220067384291668
INFO:root:epoch: 171, the diffusion loss is 0.41943784939999484
INFO:root:epoch: 172, the diffusion loss is 0.41815367462683695
INFO:root:epoch: 173, the diffusion loss is 0.4227605510731133
INFO:root:epoch: 174, the diffusion loss is 0.42479686043700393
INFO:root:epoch: 175, the diffusion loss is 0.42364918638248833
INFO:root:epoch: 176, the diffusion loss is 0.4187009133854691
INFO:root:epoch: 177, the diffusion loss is 0.4161452340836428
INFO:root:epoch: 178, the diffusion loss is 0.41249363337244305
INFO:root:epoch: 179, the diffusion loss is 0.4231487117251571
INFO:root:epoch: 180, the diffusion loss is 0.4209600474153246
INFO:root:epoch: 181, the diffusion loss is 0.42931877167857424
INFO:root:epoch: 182, the diffusion loss is 0.41931693772880396
INFO:root:epoch: 183, the diffusion loss is 0.4377783415268879
INFO:root:epoch: 184, the diffusion loss is 0.42421042919158936
INFO:root:epoch: 185, the diffusion loss is 0.4174345458040432
INFO:root:epoch: 186, the diffusion loss is 0.4159585790974753
INFO:root:epoch: 187, the diffusion loss is 0.4126293549732286
INFO:root:epoch: 188, the diffusion loss is 0.41970441292743293
INFO:root:epoch: 189, the diffusion loss is 0.42480875703753257
INFO:root:epoch: 190, the diffusion loss is 0.42719369031945054
INFO:root:epoch: 191, the diffusion loss is 0.41413767240485366
INFO:root:epoch: 192, the diffusion loss is 0.4230594130194917
INFO:root:epoch: 193, the diffusion loss is 0.41308795128549847
INFO:root:epoch: 194, the diffusion loss is 0.41440150932389863
INFO:root:epoch: 195, the diffusion loss is 0.4227378800207255
INFO:root:epoch: 196, the diffusion loss is 0.423204139179113
INFO:root:epoch: 197, the diffusion loss is 0.42929045460662063
INFO:root:epoch: 198, the diffusion loss is 0.407435169633554
INFO:root:epoch: 199, the diffusion loss is 0.4108768373119588
INFO:root:epoch: 200, the diffusion loss is 0.41889321864867696
INFO:root:the number of generated features is 2480
INFO:root:sampling batch:1024
INFO:root:sampling batch:1024
INFO:root:sampling batch:432
INFO:root:Test performance on test set.
INFO:root:fc_norm = False in model config, fc_layer = nn.Linear
INFO:root:'none' given in ['ensemble_info']['name'], load regular network.
INFO:root:cnn training loss is 0.33229451974232993; cnn training accuracy is 88.47
INFO:root:epoch: 0: 
INFO:root:Many Medium Few shot Top1 Acc: [80.6375, 42.15, 0.0]
INFO:root:Test Error:   Accuracy: 72.94, Avg loss: 1.0342 
INFO:root:Many Medium Few shot Top1 Acc: [82.675, 74.65, 0.0]
INFO:root:Test Error:   Accuracy: 72.94, Avg loss: 1.0342 
INFO:root:Label Shift Accracy is: 81.07
INFO:root:

