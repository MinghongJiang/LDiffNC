INFO:root:--epoch: 400 --dataset: CIFAR100 --imb_factor:0.01 --feature_ratio:0.2 --diffusion_step:1000 (DDPM official)
INFO:root:Test performance on test set.
INFO:root:fc_norm = False in model config, fc_layer = nn.Linear
INFO:root:'none' given in ['ensemble_info']['name'], load regular network.
INFO:root:epoch: 0, the diffusion loss is 17.088096689346226
INFO:root:epoch: 1, the diffusion loss is 3.510635646276696
INFO:root:epoch: 2, the diffusion loss is 1.727882790011029
INFO:root:epoch: 3, the diffusion loss is 1.2183141957881838
INFO:root:epoch: 4, the diffusion loss is 1.1514240738957426
INFO:root:epoch: 5, the diffusion loss is 1.040627504504004
INFO:root:epoch: 6, the diffusion loss is 0.8954701146414114
INFO:root:epoch: 7, the diffusion loss is 0.8325515333996263
INFO:root:epoch: 8, the diffusion loss is 0.8477491168088691
INFO:root:epoch: 9, the diffusion loss is 0.9126031800758007
INFO:root:epoch: 10, the diffusion loss is 0.7732912107955577
INFO:root:epoch: 11, the diffusion loss is 0.7526411275530971
INFO:root:epoch: 12, the diffusion loss is 0.7416951240495194
INFO:root:epoch: 13, the diffusion loss is 0.7549458520356999
INFO:root:epoch: 14, the diffusion loss is 0.7194299767183703
INFO:root:epoch: 15, the diffusion loss is 0.7584879855776943
INFO:root:epoch: 16, the diffusion loss is 0.7287400004475616
INFO:root:epoch: 17, the diffusion loss is 0.711847863918127
INFO:root:epoch: 18, the diffusion loss is 0.7295584387557451
INFO:root:epoch: 19, the diffusion loss is 0.7436044368633005
INFO:root:epoch: 20, the diffusion loss is 0.7145254223845726
INFO:root:epoch: 21, the diffusion loss is 0.7172323174254839
INFO:root:epoch: 22, the diffusion loss is 0.7109317488448564
INFO:root:epoch: 23, the diffusion loss is 0.7296262064645457
INFO:root:epoch: 24, the diffusion loss is 0.719603230786878
INFO:root:epoch: 25, the diffusion loss is 0.7617033137831577
INFO:root:epoch: 26, the diffusion loss is 0.6825454054876815
INFO:root:epoch: 27, the diffusion loss is 0.8173913761626842
INFO:root:epoch: 28, the diffusion loss is 0.7882301557895749
INFO:root:epoch: 29, the diffusion loss is 0.7045344571734584
INFO:root:epoch: 30, the diffusion loss is 0.7026165945585384
INFO:root:epoch: 31, the diffusion loss is 0.6893286510955455
INFO:root:epoch: 32, the diffusion loss is 0.690896610881007
INFO:root:epoch: 33, the diffusion loss is 0.6899332806121471
INFO:root:epoch: 34, the diffusion loss is 0.6862727084825205
INFO:root:epoch: 35, the diffusion loss is 0.7484396612921427
INFO:root:epoch: 36, the diffusion loss is 0.7094942456067994
INFO:root:epoch: 37, the diffusion loss is 0.6918167444162591
INFO:root:epoch: 38, the diffusion loss is 0.6728734831477321
INFO:root:epoch: 39, the diffusion loss is 0.6879718580911326
INFO:root:epoch: 40, the diffusion loss is 0.6714320016461749
INFO:root:epoch: 41, the diffusion loss is 0.7055469335511674
INFO:root:epoch: 42, the diffusion loss is 0.6972090421720992
INFO:root:epoch: 43, the diffusion loss is 0.6793834594793098
INFO:root:epoch: 44, the diffusion loss is 0.6499742491300716
INFO:root:epoch: 45, the diffusion loss is 0.6938297748565674
INFO:root:epoch: 46, the diffusion loss is 0.6580248488936313
INFO:root:epoch: 47, the diffusion loss is 0.6714596595875052
INFO:root:epoch: 48, the diffusion loss is 0.663594896017119
INFO:root:epoch: 49, the diffusion loss is 0.6568964622741522
INFO:root:epoch: 50, the diffusion loss is 0.6650372452514116
INFO:root:epoch: 51, the diffusion loss is 0.6698880458987037
INFO:root:epoch: 52, the diffusion loss is 0.7708811136179192
INFO:root:epoch: 53, the diffusion loss is 0.6684425043505292
INFO:root:epoch: 54, the diffusion loss is 0.6499048582343168
INFO:root:epoch: 55, the diffusion loss is 0.6593348134395688
INFO:root:epoch: 56, the diffusion loss is 0.6494349047195079
INFO:root:epoch: 57, the diffusion loss is 0.671867732391801
INFO:root:epoch: 58, the diffusion loss is 0.657498417898666
INFO:root:epoch: 59, the diffusion loss is 0.6533388634060704
INFO:root:epoch: 60, the diffusion loss is 0.659347208433373
INFO:root:epoch: 61, the diffusion loss is 0.6618906467459923
INFO:root:epoch: 62, the diffusion loss is 0.665085238079692
INFO:root:epoch: 63, the diffusion loss is 0.6499640373296516
INFO:root:epoch: 64, the diffusion loss is 0.6570106661596964
INFO:root:epoch: 65, the diffusion loss is 0.6355504254962123
INFO:root:epoch: 66, the diffusion loss is 0.6792441454044608
INFO:root:epoch: 67, the diffusion loss is 0.6422827479451202
INFO:root:epoch: 68, the diffusion loss is 0.660122623277265
INFO:root:epoch: 69, the diffusion loss is 0.6728611740955087
INFO:root:epoch: 70, the diffusion loss is 0.6499227812123853
INFO:root:epoch: 71, the diffusion loss is 0.6501563177552334
INFO:root:epoch: 72, the diffusion loss is 0.6518191348674686
INFO:root:epoch: 73, the diffusion loss is 0.6463233384975168
INFO:root:epoch: 74, the diffusion loss is 0.6471325103626695
INFO:root:epoch: 75, the diffusion loss is 0.6496460299159206
INFO:root:epoch: 76, the diffusion loss is 0.6480760435725368
INFO:root:epoch: 77, the diffusion loss is 0.6467845190403073
INFO:root:epoch: 78, the diffusion loss is 0.6439864552298258
INFO:root:epoch: 79, the diffusion loss is 0.6421684899995493
INFO:root:epoch: 80, the diffusion loss is 0.6563341520553412
INFO:root:epoch: 81, the diffusion loss is 0.6497528525285943
INFO:root:epoch: 82, the diffusion loss is 0.6381919675095137
INFO:root:epoch: 83, the diffusion loss is 0.6667544107104457
INFO:root:epoch: 84, the diffusion loss is 0.6385680645011192
INFO:root:epoch: 85, the diffusion loss is 0.6458180269529653
INFO:root:epoch: 86, the diffusion loss is 0.6521152950996576
INFO:root:epoch: 87, the diffusion loss is 0.6451352626778358
INFO:root:epoch: 88, the diffusion loss is 0.6682444755421129
INFO:root:epoch: 89, the diffusion loss is 0.624737118565759
INFO:root:epoch: 90, the diffusion loss is 0.6455286477887353
INFO:root:epoch: 91, the diffusion loss is 0.6394412670024606
INFO:root:epoch: 92, the diffusion loss is 0.6389390853948371
INFO:root:epoch: 93, the diffusion loss is 0.637735151967337
INFO:root:epoch: 94, the diffusion loss is 0.6383530677751054
INFO:root:epoch: 95, the diffusion loss is 0.6834683154904565
INFO:root:epoch: 96, the diffusion loss is 0.6451775209848271
INFO:root:epoch: 97, the diffusion loss is 0.6387573341990627
INFO:root:epoch: 98, the diffusion loss is 0.64082390208577
INFO:root:epoch: 99, the diffusion loss is 0.6346612586531528
INFO:root:epoch: 100, the diffusion loss is 0.6359030271685401
INFO:root:epoch: 101, the diffusion loss is 0.6365102085956308
INFO:root:epoch: 102, the diffusion loss is 0.6623074550961339
INFO:root:epoch: 103, the diffusion loss is 0.632439984831699
INFO:root:epoch: 104, the diffusion loss is 0.6385752614154372
INFO:root:epoch: 105, the diffusion loss is 0.6359242796897888
INFO:root:epoch: 106, the diffusion loss is 0.6669212995573531
INFO:root:epoch: 107, the diffusion loss is 0.6445029960122219
INFO:root:epoch: 108, the diffusion loss is 0.6334472367929858
INFO:root:epoch: 109, the diffusion loss is 0.6549409087314162
INFO:root:epoch: 110, the diffusion loss is 0.6557676625806231
INFO:root:epoch: 111, the diffusion loss is 0.659702485383943
INFO:root:epoch: 112, the diffusion loss is 0.6496648026067157
INFO:root:epoch: 113, the diffusion loss is 0.6395862268847089
INFO:root:epoch: 114, the diffusion loss is 0.6344939012860142
INFO:root:epoch: 115, the diffusion loss is 0.650233483591745
INFO:root:epoch: 116, the diffusion loss is 0.6413331392199494
INFO:root:epoch: 117, the diffusion loss is 0.6464552740718044
INFO:root:epoch: 118, the diffusion loss is 0.6334939903991167
INFO:root:epoch: 119, the diffusion loss is 0.6472811407821123
INFO:root:epoch: 120, the diffusion loss is 0.6389096767403358
INFO:root:epoch: 121, the diffusion loss is 0.6276171249012614
INFO:root:epoch: 122, the diffusion loss is 0.6366355183512665
INFO:root:epoch: 123, the diffusion loss is 0.644599620686021
INFO:root:epoch: 124, the diffusion loss is 0.644741112409636
INFO:root:epoch: 125, the diffusion loss is 0.6297097857608351
INFO:root:epoch: 126, the diffusion loss is 0.6405482527821563
INFO:root:epoch: 127, the diffusion loss is 0.6438476512598437
INFO:root:epoch: 128, the diffusion loss is 0.6305816644846007
INFO:root:epoch: 129, the diffusion loss is 0.6236149571662726
INFO:root:epoch: 130, the diffusion loss is 0.6377901240836742
INFO:root:epoch: 131, the diffusion loss is 0.6332795287287513
INFO:root:epoch: 132, the diffusion loss is 0.6453128623407941
INFO:root:epoch: 133, the diffusion loss is 0.6380157678626305
INFO:root:epoch: 134, the diffusion loss is 0.632728327152341
INFO:root:epoch: 135, the diffusion loss is 0.6317300394523976
INFO:root:epoch: 136, the diffusion loss is 0.6343587137932001
INFO:root:epoch: 137, the diffusion loss is 0.6387108148530473
INFO:root:epoch: 138, the diffusion loss is 0.6293071549992229
INFO:root:epoch: 139, the diffusion loss is 0.6465316484140795
INFO:root:epoch: 140, the diffusion loss is 0.6379509706829869
INFO:root:epoch: 141, the diffusion loss is 0.6322079356326613
INFO:root:epoch: 142, the diffusion loss is 0.6442170448081438
INFO:root:epoch: 143, the diffusion loss is 0.638616778129755
INFO:root:epoch: 144, the diffusion loss is 0.6299611440924711
INFO:root:epoch: 145, the diffusion loss is 0.6337057657020037
INFO:root:epoch: 146, the diffusion loss is 0.6351639032363892
INFO:root:epoch: 147, the diffusion loss is 0.6268812625907189
INFO:root:epoch: 148, the diffusion loss is 0.6383684915165568
INFO:root:epoch: 149, the diffusion loss is 0.6237978061964345
INFO:root:epoch: 150, the diffusion loss is 0.6275828702505245
INFO:root:epoch: 151, the diffusion loss is 0.6421633293462354
INFO:root:epoch: 152, the diffusion loss is 0.6296542952227038
INFO:root:epoch: 153, the diffusion loss is 0.6353983962258627
INFO:root:epoch: 154, the diffusion loss is 0.6201908921086511
INFO:root:epoch: 155, the diffusion loss is 0.6362782481104828
INFO:root:epoch: 156, the diffusion loss is 0.6256215877311174
INFO:root:epoch: 157, the diffusion loss is 0.6360290507937587
INFO:root:epoch: 158, the diffusion loss is 0.6481658026229503
INFO:root:epoch: 159, the diffusion loss is 0.6316460398740547
INFO:root:epoch: 160, the diffusion loss is 0.6342650388562402
INFO:root:epoch: 161, the diffusion loss is 0.6307105422019958
INFO:root:epoch: 162, the diffusion loss is 0.6296175856922948
INFO:root:epoch: 163, the diffusion loss is 0.6271894435549892
INFO:root:epoch: 164, the diffusion loss is 0.6275895958723023
INFO:root:epoch: 165, the diffusion loss is 0.6310100846512373
INFO:root:epoch: 166, the diffusion loss is 0.6183541042860164
INFO:root:epoch: 167, the diffusion loss is 0.6344593458397444
INFO:root:epoch: 168, the diffusion loss is 0.6267570825510247
INFO:root:epoch: 169, the diffusion loss is 0.6334783074467681
INFO:root:epoch: 170, the diffusion loss is 0.6275479724240858
INFO:root:epoch: 171, the diffusion loss is 0.6313032410865607
INFO:root:epoch: 172, the diffusion loss is 0.6259641051292419
INFO:root:epoch: 173, the diffusion loss is 0.6294437965681386
INFO:root:epoch: 174, the diffusion loss is 0.6267711603364279
INFO:root:epoch: 175, the diffusion loss is 0.6321211692898773
INFO:root:epoch: 176, the diffusion loss is 0.631020397640938
INFO:root:epoch: 177, the diffusion loss is 0.6277396401693655
INFO:root:epoch: 178, the diffusion loss is 0.6376316006793532
INFO:root:epoch: 179, the diffusion loss is 0.6225275743839352
INFO:root:epoch: 180, the diffusion loss is 0.6333760355794152
INFO:root:epoch: 181, the diffusion loss is 0.6261181637298229
INFO:root:epoch: 182, the diffusion loss is 0.6211928309396256
INFO:root:epoch: 183, the diffusion loss is 0.6319449031075766
INFO:root:epoch: 184, the diffusion loss is 0.631662130355835
INFO:root:epoch: 185, the diffusion loss is 0.6354804981586545
INFO:root:epoch: 186, the diffusion loss is 0.6305476052816524
INFO:root:epoch: 187, the diffusion loss is 0.6386159228724103
INFO:root:epoch: 188, the diffusion loss is 0.6301155228947484
INFO:root:epoch: 189, the diffusion loss is 0.6226328611373901
INFO:root:epoch: 190, the diffusion loss is 0.6338598520256752
INFO:root:epoch: 191, the diffusion loss is 0.6218451746674472
INFO:root:epoch: 192, the diffusion loss is 0.6262512345646702
INFO:root:epoch: 193, the diffusion loss is 0.6287774582241856
INFO:root:epoch: 194, the diffusion loss is 0.6189747314120448
INFO:root:epoch: 195, the diffusion loss is 0.6265511290971623
INFO:root:epoch: 196, the diffusion loss is 0.620002290537191
INFO:root:epoch: 197, the diffusion loss is 0.6240069505780242
INFO:root:epoch: 198, the diffusion loss is 0.6368369363075079
INFO:root:epoch: 199, the diffusion loss is 0.6264107171879258
INFO:root:epoch: 200, the diffusion loss is 0.6334862639737684
INFO:root:the number of generated features is 39158
INFO:root:sampling batch:1024
