INFO:root:--epoch: 400 --dataset: CIFAR100 --imb_factor:0.01 --feature_ratio:0.2 --diffusion_step:1000 (DDPM official)
INFO:root:Test performance on test set.
INFO:root:fc_norm = False in model config, fc_layer = nn.Linear
INFO:root:'none' given in ['ensemble_info']['name'], load regular network.
INFO:root:epoch: 0, the diffusion loss is 6.765883947527686
INFO:root:epoch: 1, the diffusion loss is 10.778985856577407
INFO:root:epoch: 2, the diffusion loss is 1.7524875651958376
INFO:root:epoch: 3, the diffusion loss is 1.5308177387991617
INFO:root:epoch: 4, the diffusion loss is 1.4693163564038831
INFO:root:epoch: 5, the diffusion loss is 1.032758967820988
INFO:root:epoch: 6, the diffusion loss is 0.9351618442424509
INFO:root:epoch: 7, the diffusion loss is 0.8310799751170846
INFO:root:epoch: 8, the diffusion loss is 0.8248878786730212
INFO:root:epoch: 9, the diffusion loss is 0.9946825989457064
INFO:root:epoch: 10, the diffusion loss is 0.7630898495053136
INFO:root:epoch: 11, the diffusion loss is 0.7713413349417753
INFO:root:epoch: 12, the diffusion loss is 0.8043925221576247
INFO:root:epoch: 13, the diffusion loss is 0.7331710180570913
INFO:root:epoch: 14, the diffusion loss is 0.7058144475138465
INFO:root:epoch: 15, the diffusion loss is 0.7351091102112172
INFO:root:epoch: 16, the diffusion loss is 0.7919425035631934
INFO:root:epoch: 17, the diffusion loss is 0.7614441416984381
INFO:root:epoch: 18, the diffusion loss is 0.7367276549339294
INFO:root:epoch: 19, the diffusion loss is 0.7785939782164818
INFO:root:epoch: 20, the diffusion loss is 0.7072712709737379
INFO:root:epoch: 21, the diffusion loss is 0.7864077465478764
INFO:root:epoch: 22, the diffusion loss is 0.7039978171503821
INFO:root:epoch: 23, the diffusion loss is 0.6896390790163085
INFO:root:epoch: 24, the diffusion loss is 0.7234293083811916
INFO:root:epoch: 25, the diffusion loss is 0.6838210405305375
INFO:root:epoch: 26, the diffusion loss is 0.686236787674039
INFO:root:epoch: 27, the diffusion loss is 0.701790849829829
INFO:root:epoch: 28, the diffusion loss is 0.7197227505750434
INFO:root:epoch: 29, the diffusion loss is 0.7066914009493451
INFO:root:epoch: 30, the diffusion loss is 0.733851270620213
INFO:root:epoch: 31, the diffusion loss is 0.6827061550561772
INFO:root:epoch: 32, the diffusion loss is 0.6900302934092145
INFO:root:epoch: 33, the diffusion loss is 0.6875354314959327
INFO:root:epoch: 34, the diffusion loss is 0.6713062663410985
INFO:root:epoch: 35, the diffusion loss is 0.6904567466225735
INFO:root:epoch: 36, the diffusion loss is 0.707127034664154
INFO:root:epoch: 37, the diffusion loss is 0.6862894726354022
INFO:root:epoch: 38, the diffusion loss is 0.6623325264731119
INFO:root:epoch: 39, the diffusion loss is 0.6973435379738031
INFO:root:epoch: 40, the diffusion loss is 0.6737017160238221
INFO:root:epoch: 41, the diffusion loss is 0.6785185586574466
INFO:root:epoch: 42, the diffusion loss is 0.6672491999559624
INFO:root:epoch: 43, the diffusion loss is 0.6658891661222591
INFO:root:epoch: 44, the diffusion loss is 0.6597101827000462
INFO:root:epoch: 45, the diffusion loss is 0.6793116968731547
INFO:root:epoch: 46, the diffusion loss is 0.6521477394325789
INFO:root:epoch: 47, the diffusion loss is 0.6588896998139315
INFO:root:epoch: 48, the diffusion loss is 0.6631995037544606
INFO:root:epoch: 49, the diffusion loss is 0.7291515469551086
INFO:root:epoch: 50, the diffusion loss is 0.647352721802024
INFO:root:epoch: 51, the diffusion loss is 0.6739417494729508
INFO:root:epoch: 52, the diffusion loss is 0.750310014846713
INFO:root:epoch: 53, the diffusion loss is 0.6545917876931124
INFO:root:epoch: 54, the diffusion loss is 0.6543938378955043
INFO:root:epoch: 55, the diffusion loss is 0.6653379104858221
INFO:root:epoch: 56, the diffusion loss is 0.6693977339323177
INFO:root:epoch: 57, the diffusion loss is 0.6776795733806699
INFO:root:epoch: 58, the diffusion loss is 0.6546972227651019
INFO:root:epoch: 59, the diffusion loss is 0.6496902066607808
INFO:root:epoch: 60, the diffusion loss is 0.6714990610300109
INFO:root:epoch: 61, the diffusion loss is 0.6490944318993147
INFO:root:epoch: 62, the diffusion loss is 0.6427295291146566
INFO:root:epoch: 63, the diffusion loss is 0.6609385872996131
INFO:root:epoch: 64, the diffusion loss is 0.6435073406197304
INFO:root:epoch: 65, the diffusion loss is 0.6392766126366549
INFO:root:epoch: 66, the diffusion loss is 0.6492413961610128
INFO:root:epoch: 67, the diffusion loss is 0.6749638249707777
INFO:root:epoch: 68, the diffusion loss is 0.6517223826674527
INFO:root:epoch: 69, the diffusion loss is 0.6462546240451724
INFO:root:epoch: 70, the diffusion loss is 0.6650336273880892
INFO:root:epoch: 71, the diffusion loss is 0.6500541221263797
INFO:root:epoch: 72, the diffusion loss is 0.6717545778252357
INFO:root:epoch: 73, the diffusion loss is 0.6489199843517569
INFO:root:epoch: 74, the diffusion loss is 0.6492234953614169
INFO:root:epoch: 75, the diffusion loss is 0.6681083385334459
INFO:root:epoch: 76, the diffusion loss is 0.6470162743745849
INFO:root:epoch: 77, the diffusion loss is 0.6432134176409522
INFO:root:epoch: 78, the diffusion loss is 0.6549974818562352
INFO:root:epoch: 79, the diffusion loss is 0.6511417655057685
INFO:root:epoch: 80, the diffusion loss is 0.6572837621666664
INFO:root:epoch: 81, the diffusion loss is 0.6459135967631673
INFO:root:epoch: 82, the diffusion loss is 0.6425942362740983
INFO:root:epoch: 83, the diffusion loss is 0.6623134834821834
INFO:root:epoch: 84, the diffusion loss is 0.6311171332070994
INFO:root:epoch: 85, the diffusion loss is 0.6395953671876774
INFO:root:epoch: 86, the diffusion loss is 0.6688118022541667
INFO:root:epoch: 87, the diffusion loss is 0.6712636129800663
INFO:root:epoch: 88, the diffusion loss is 0.8581868160602658
INFO:root:epoch: 89, the diffusion loss is 0.6302589593931686
INFO:root:epoch: 90, the diffusion loss is 0.6502065727877062
INFO:root:epoch: 91, the diffusion loss is 0.6459742313207582
INFO:root:epoch: 92, the diffusion loss is 0.6511901256649993
INFO:root:epoch: 93, the diffusion loss is 0.6479198794032253
INFO:root:epoch: 94, the diffusion loss is 0.6423394000807474
INFO:root:epoch: 95, the diffusion loss is 0.6701301835304083
INFO:root:epoch: 96, the diffusion loss is 0.6405705948208653
INFO:root:epoch: 97, the diffusion loss is 0.6364449678465377
INFO:root:epoch: 98, the diffusion loss is 0.6389764519624932
INFO:root:epoch: 99, the diffusion loss is 0.6355669082597245
INFO:root:epoch: 100, the diffusion loss is 0.7695716661076213
INFO:root:epoch: 101, the diffusion loss is 0.6528243519539056
INFO:root:epoch: 102, the diffusion loss is 0.6278373100036798
INFO:root:epoch: 103, the diffusion loss is 0.6344075979188432
INFO:root:epoch: 104, the diffusion loss is 0.6419901584469995
INFO:root:epoch: 105, the diffusion loss is 0.6330493300460106
INFO:root:epoch: 106, the diffusion loss is 0.6432938243067542
INFO:root:epoch: 107, the diffusion loss is 0.6493978042935216
INFO:root:epoch: 108, the diffusion loss is 0.647833900396214
INFO:root:epoch: 109, the diffusion loss is 0.6413240294123805
INFO:root:epoch: 110, the diffusion loss is 0.6437492231990016
INFO:root:epoch: 111, the diffusion loss is 0.6449441133543502
INFO:root:epoch: 112, the diffusion loss is 0.6507796589718309
INFO:root:epoch: 113, the diffusion loss is 0.6502923300099928
INFO:root:epoch: 114, the diffusion loss is 0.6456456336864206
INFO:root:epoch: 115, the diffusion loss is 0.640764826952025
INFO:root:epoch: 116, the diffusion loss is 0.6412729939749074
INFO:root:epoch: 117, the diffusion loss is 0.631918050522028
INFO:root:epoch: 118, the diffusion loss is 0.6374491577924684
INFO:root:epoch: 119, the diffusion loss is 0.6414212986480358
INFO:root:epoch: 120, the diffusion loss is 0.6351031771925992
INFO:root:epoch: 121, the diffusion loss is 0.6282471362934556
INFO:root:epoch: 122, the diffusion loss is 0.6345133850740832
INFO:root:epoch: 123, the diffusion loss is 0.6682555703229682
INFO:root:epoch: 124, the diffusion loss is 0.6367633439773737
INFO:root:epoch: 125, the diffusion loss is 0.6368906844493954
INFO:root:epoch: 126, the diffusion loss is 0.6390584693398587
INFO:root:epoch: 127, the diffusion loss is 0.6406224744264469
INFO:root:epoch: 128, the diffusion loss is 0.6352463530939679
INFO:root:epoch: 129, the diffusion loss is 0.6284055224684781
INFO:root:epoch: 130, the diffusion loss is 0.63669617508733
INFO:root:epoch: 131, the diffusion loss is 0.6315537469331608
INFO:root:epoch: 132, the diffusion loss is 0.6388428599335426
INFO:root:epoch: 133, the diffusion loss is 0.6349035418310831
INFO:root:epoch: 134, the diffusion loss is 0.6342975871507511
INFO:root:epoch: 135, the diffusion loss is 0.6316721855207931
INFO:root:epoch: 136, the diffusion loss is 0.6310696047405864
INFO:root:epoch: 137, the diffusion loss is 0.6318165174750394
INFO:root:epoch: 138, the diffusion loss is 0.6296280151189759
INFO:root:epoch: 139, the diffusion loss is 0.6441234433373739
INFO:root:epoch: 140, the diffusion loss is 0.6335419957027879
INFO:root:epoch: 141, the diffusion loss is 0.6276895681092906
INFO:root:epoch: 142, the diffusion loss is 0.6478917529416639
INFO:root:epoch: 143, the diffusion loss is 0.6342376290365707
INFO:root:epoch: 144, the diffusion loss is 0.6377242165942525
INFO:root:epoch: 145, the diffusion loss is 0.6281222978303599
INFO:root:epoch: 146, the diffusion loss is 0.6340887574262397
INFO:root:epoch: 147, the diffusion loss is 0.631152889063192
INFO:root:epoch: 148, the diffusion loss is 0.6430627440297326
INFO:root:epoch: 149, the diffusion loss is 0.6232307012691054
INFO:root:epoch: 150, the diffusion loss is 0.6252722171849983
INFO:root:epoch: 151, the diffusion loss is 0.635289192199707
INFO:root:epoch: 152, the diffusion loss is 0.6297115170678427
INFO:root:epoch: 153, the diffusion loss is 0.6287726371787316
INFO:root:epoch: 154, the diffusion loss is 0.6196614531583564
INFO:root:epoch: 155, the diffusion loss is 0.6492696279703185
INFO:root:epoch: 156, the diffusion loss is 0.6317085249479427
INFO:root:epoch: 157, the diffusion loss is 0.6317742993665296
INFO:root:epoch: 158, the diffusion loss is 0.6521295128866683
INFO:root:epoch: 159, the diffusion loss is 0.634637784126193
INFO:root:epoch: 160, the diffusion loss is 0.6336917142535365
INFO:root:epoch: 161, the diffusion loss is 0.6273398953814839
INFO:root:epoch: 162, the diffusion loss is 0.6300909491472466
INFO:root:epoch: 163, the diffusion loss is 0.6333837897278541
INFO:root:epoch: 164, the diffusion loss is 0.6292548151903374
INFO:root:epoch: 165, the diffusion loss is 0.6236114183137583
INFO:root:epoch: 166, the diffusion loss is 0.6179207216861636
INFO:root:epoch: 167, the diffusion loss is 0.6404384735018708
INFO:root:epoch: 168, the diffusion loss is 0.6356431481450103
INFO:root:epoch: 169, the diffusion loss is 0.6334908909575884
INFO:root:epoch: 170, the diffusion loss is 0.6252939936726593
INFO:root:epoch: 171, the diffusion loss is 0.6332247825556023
INFO:root:epoch: 172, the diffusion loss is 0.6271229247714198
INFO:root:epoch: 173, the diffusion loss is 0.6233799942704135
INFO:root:epoch: 174, the diffusion loss is 0.6214312509048817
INFO:root:epoch: 175, the diffusion loss is 0.6337722359701644
INFO:root:epoch: 176, the diffusion loss is 0.6291839716046356
INFO:root:epoch: 177, the diffusion loss is 0.6318982770276624
INFO:root:epoch: 178, the diffusion loss is 0.6311785412389178
INFO:root:epoch: 179, the diffusion loss is 0.6211151854936466
INFO:root:epoch: 180, the diffusion loss is 0.6333314596220504
INFO:root:epoch: 181, the diffusion loss is 0.6250897091488505
INFO:root:epoch: 182, the diffusion loss is 0.6223046044970668
INFO:root:epoch: 183, the diffusion loss is 0.6291755687358768
INFO:root:epoch: 184, the diffusion loss is 0.6265090080194695
INFO:root:epoch: 185, the diffusion loss is 0.6313848204390947
INFO:root:epoch: 186, the diffusion loss is 0.6259712881820146
INFO:root:epoch: 187, the diffusion loss is 0.6385611254115438
INFO:root:epoch: 188, the diffusion loss is 0.6326597485431406
INFO:root:epoch: 189, the diffusion loss is 0.6244142485219378
INFO:root:epoch: 190, the diffusion loss is 0.630621284939522
INFO:root:epoch: 191, the diffusion loss is 0.6212140086085297
INFO:root:epoch: 192, the diffusion loss is 0.6264716511548951
INFO:root:epoch: 193, the diffusion loss is 0.6233430490937344
INFO:root:epoch: 194, the diffusion loss is 0.6226804436639298
INFO:root:epoch: 195, the diffusion loss is 0.6220312589822814
INFO:root:epoch: 196, the diffusion loss is 0.6213606498962225
INFO:root:epoch: 197, the diffusion loss is 0.6204121195992758
INFO:root:epoch: 198, the diffusion loss is 0.6308055617088495
INFO:root:epoch: 199, the diffusion loss is 0.6267777210058167
INFO:root:epoch: 200, the diffusion loss is 0.6246571069539979
INFO:root:the number of generated features is 39158
INFO:root:sampling batch:1024
